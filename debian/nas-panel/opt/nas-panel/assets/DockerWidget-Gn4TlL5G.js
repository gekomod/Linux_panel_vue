import{_ as U,r as u,y as f,k as V,O as j,b as y,p as A,e as E,o as n,w as r,c as l,n as F,a as s,g as h,l as N,I as b,F as M,m as O,h as k,t as w,q as v,s as d}from"./index-DxMqavst.js";const W={class:"widget-header"},q={key:0,class:"docker-offline"},L={key:1,class:"widget-content"},R={key:0,class:"no-containers"},Z={class:"container-name"},G={name:"DockerWidget",displayName:"Kontenery Docker"},H=Object.assign(G,{setup(J){const c=u([]),m=u(!1),i=u("unknown"),p=u(!1);let _=null;const D=f(()=>i.value==="active"),x=f(()=>i.value==="active"?"Docker działa":"Docker wyłączony"),I=f(()=>i.value==="active"?"success":"danger"),g=async()=>{try{const e=await v.get("/services/docker/status");i.value=e.data.status||"unknown",D.value?await C():c.value=[]}catch(e){console.error("Błąd pobierania statusu Dockera:",e),i.value="inactive"}},C=async()=>{try{m.value=!0;const e=await v.get("/services/docker/containers",{params:{all:!0}});let a=[];Array.isArray(e.data)?a=e.data:e.data.containers?a=e.data.containers:e.data.data&&(a=e.data.data),c.value=a.map(t=>({id:t.ID||t.containerID,names:t.Names||t.containerNames,state:t.State||t.status,loading:!1}))}catch(e){console.error("Błąd pobierania kontenerów:",e),d.error("Nie udało się pobrać listy kontenerów"),c.value=[]}finally{m.value=!1}},S=async()=>{try{p.value=!0,await v.post("/services/docker/start"),d.success("Docker został uruchomiony"),await g()}catch(e){console.error("Błąd uruchamiania Dockera:",e),d.error("Nie udało się uruchomić Dockera")}finally{p.value=!1}},$=async e=>{try{e.loading=!0;const a=e.state==="running"?"stop":"start";await v.post(`/services/docker/container/${e.id}/${a}`),d.success(`Kontener ${e.names} ${a==="stop"?"zatrzymany":"uruchomiony"}`),e.state=a==="stop"?"exited":"running"}catch(a){console.error("Błąd zmiany stanu kontenera:",a),d.error(`Nie udało się zmienić stanu kontenera ${e.names}`)}finally{e.loading=!1}};return V(()=>{g(),_=setInterval(g,15e3)}),j(()=>{_&&clearInterval(_)}),(e,a)=>{const t=y("el-tag"),z=y("el-button"),B=y("el-empty"),T=y("el-card"),K=A("loading");return n(),E(T,{class:"widget-card",shadow:"hover"},{header:r(()=>[k("div",W,[s(N(b),{icon:"mdi:docker",width:"20",class:"header-icon"}),a[0]||(a[0]=k("span",null,"Kontenery Docker",-1)),s(t,{type:I.value,size:"small",class:"status-tag"},{default:r(()=>[h(w(x.value),1)]),_:1},8,["type"])])]),default:r(()=>[D.value?F((n(),l("div",L,[c.value.length===0?(n(),l("div",R,[s(B,{description:"Brak uruchomionych kontenerów"})])):(n(!0),l(M,{key:1},O(c.value,o=>(n(),l("div",{key:o.id,class:"container-item"},[k("div",Z,[k("span",null,w(o.names),1)]),s(z,{type:o.state==="running"?"success":"danger",size:"small",plain:"",onClick:P=>$(o),loading:o.loading},{default:r(()=>[h(w(o.state==="running"?"Uruchomiony":"Zatrzymany"),1)]),_:2},1032,["type","onClick","loading"])]))),128))])),[[K,m.value]]):(n(),l("div",q,[s(B,{description:"Docker jest wyłączony"},{default:r(()=>[s(z,{type:"primary",size:"small",onClick:S,loading:p.value},{default:r(()=>[s(N(b),{icon:"mdi:power",class:"button-icon"}),a[1]||(a[1]=h(" Uruchom Docker "))]),_:1,__:[1]},8,["loading"])]),_:1})]))]),_:1})}}}),X=U(H,[["__scopeId","data-v-8f64400a"]]);export{X as default};
