import{_ as Z,r as _,y as q,k as O,c as Q,o as V,h as d,n as W,a as e,g as s,w as t,l as m,I as f,b as n,p as G,e as H,t as r,q as B,s as k,z as J}from"./index-DxMqavst.js";const K={class:"process-monitor"},R={class:"monitor-header"},X={class:"controls"},Y={class:"percentage"},ee={class:"percentage"},te={class:"command"},oe={__name:"ProcessMonitor",setup(ae){const b=_(!1),h=_([]),g=_(""),v=_(!1),c=_({}),D=q(()=>{if(!g.value)return h.value;const a=g.value.toLowerCase();return h.value.filter(o=>o.name.toLowerCase().includes(a)||o.pid.toString().includes(a)||o.user.toLowerCase().includes(a)||o.command.toLowerCase().includes(a))}),M=a=>a>70?"#f56c6c":a>30?"#e6a23c":"#67c23a",N=a=>a>80?"#f56c6c":a>50?"#e6a23c":"#67c23a",z=a=>{switch(a.toLowerCase()){case"running":return"success";case"sleeping":return"primary";case"stopped":return"warning";case"zombie":return"danger";default:return"info"}},w=async()=>{try{b.value=!0;const a=await B.get("/diagnostics/processes");h.value=a.data.processes.map(o=>({...o,cpu:parseFloat(o.cpu),memory:parseFloat(o.memory),protected:o.user==="root"||o.pid<100}))}catch(a){k.error("Błąd podczas ładowania procesów"),console.error(a)}finally{b.value=!1}},S=()=>{w()},U=a=>{J.confirm(`Czy na pewno chcesz zakończyć proces ${a}?`,"Potwierdzenie",{confirmButtonText:"Zakończ",cancelButtonText:"Anuluj",type:"warning"}).then(async()=>{try{await B.post("/diagnostics/processes/kill",{pid:a}),k.success(`Proces ${a} został zakończony`),w()}catch(o){k.error(`Błąd podczas kończenia procesu: ${o.response?.data?.message||o.message}`)}}).catch(()=>{})},$=a=>{c.value=a,v.value=!0};return O(()=>{w()}),(a,o)=>{const p=n("el-icon"),y=n("el-button"),I=n("el-input"),u=n("el-table-column"),C=n("el-progress"),x=n("el-tag"),P=n("el-tooltip"),L=n("el-button-group"),j=n("el-table"),i=n("el-descriptions-item"),A=n("el-descriptions"),F=n("el-dialog"),T=G("loading");return V(),Q("div",K,[d("div",R,[d("h2",null,[e(p,null,{default:t(()=>[e(m(f),{icon:"mdi:chart-box"})]),_:1}),o[3]||(o[3]=s(" Monitor procesów systemowych "))]),d("div",X,[e(y,{size:"small",onClick:S,loading:b.value},{default:t(()=>[e(p,null,{default:t(()=>[e(m(f),{icon:"mdi:refresh"})]),_:1}),o[4]||(o[4]=s(" Odśwież "))]),_:1,__:[4]},8,["loading"]),e(I,{modelValue:g.value,"onUpdate:modelValue":o[0]||(o[0]=l=>g.value=l),placeholder:"Wyszukaj proces...",clearable:"",style:{width:"200px"},size:"small"},{prefix:t(()=>[e(p,null,{default:t(()=>[e(m(f),{icon:"mdi:magnify"})]),_:1})]),_:1},8,["modelValue"])])]),W((V(),H(j,{data:D.value,style:{width:"100%"},stripe:"",border:"",height:"calc(100vh - 220px)"},{default:t(()=>[e(u,{prop:"pid",label:"PID",width:"80",sortable:""}),e(u,{prop:"name",label:"Nazwa",width:"180",sortable:""}),e(u,{prop:"user",label:"Użytkownik",width:"120",sortable:""}),e(u,{prop:"cpu",label:"CPU %",width:"100",sortable:""},{default:t(({row:l})=>[e(C,{percentage:l.cpu,color:M(l.cpu),"show-text":!1,"stroke-width":16},null,8,["percentage","color"]),d("span",Y,r(l.cpu.toFixed(1))+"%",1)]),_:1}),e(u,{prop:"memory",label:"Pamięć %",width:"120",sortable:""},{default:t(({row:l})=>[e(C,{percentage:l.memory,color:N(l.memory),"show-text":!1,"stroke-width":16},null,8,["percentage","color"]),d("span",ee,r(l.memory.toFixed(1))+"%",1)]),_:1}),e(u,{prop:"status",label:"Status",width:"100",sortable:""},{default:t(({row:l})=>[e(x,{type:z(l.status),size:"small"},{default:t(()=>[s(r(l.status),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"command",label:"Polecenie","show-overflow-tooltip":""}),e(u,{label:"Akcje",width:"120"},{default:t(({row:l})=>[e(L,null,{default:t(()=>[e(P,{content:"Zakończ proces",placement:"top"},{default:t(()=>[e(y,{size:"small",type:"danger",onClick:E=>U(l.pid),disabled:l.protected},{default:t(()=>[e(p,null,{default:t(()=>[e(m(f),{icon:"mdi:skull"})]),_:1})]),_:2},1032,["onClick","disabled"])]),_:2},1024),e(P,{content:"Szczegóły",placement:"top"},{default:t(()=>[e(y,{size:"small",type:"info",onClick:E=>$(l)},{default:t(()=>[e(p,null,{default:t(()=>[e(m(f),{icon:"mdi:information"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[T,b.value]]),e(F,{modelValue:v.value,"onUpdate:modelValue":o[2]||(o[2]=l=>v.value=l),title:"Szczegóły procesu",width:"60%"},{footer:t(()=>[e(y,{onClick:o[1]||(o[1]=l=>v.value=!1)},{default:t(()=>o[5]||(o[5]=[s("Zamknij")])),_:1,__:[5]})]),default:t(()=>[e(A,{column:2,border:""},{default:t(()=>[e(i,{label:"PID"},{default:t(()=>[s(r(c.value.pid),1)]),_:1}),e(i,{label:"Nazwa"},{default:t(()=>[s(r(c.value.name),1)]),_:1}),e(i,{label:"Użytkownik"},{default:t(()=>[s(r(c.value.user),1)]),_:1}),e(i,{label:"Status"},{default:t(()=>[e(x,{type:z(c.value.status),size:"small"},{default:t(()=>[s(r(c.value.status),1)]),_:1},8,["type"])]),_:1}),e(i,{label:"CPU %"},{default:t(()=>[s(r(c.value.cpu)+"%",1)]),_:1}),e(i,{label:"Pamięć %"},{default:t(()=>[s(r(c.value.memory)+"%",1)]),_:1}),e(i,{label:"Polecenie",span:2},{default:t(()=>[d("pre",te,r(c.value.command),1)]),_:1}),e(i,{label:"Ścieżka",span:2},{default:t(()=>[s(r(c.value.path||"N/A"),1)]),_:1}),e(i,{label:"Uruchomiono",span:2},{default:t(()=>[s(r(c.value.started||"N/A"),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},se=Z(oe,[["__scopeId","data-v-2b0a9a37"]]);export{se as default};
